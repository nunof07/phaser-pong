!function(t){"use strict";var e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),s=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},n=function(n){function o(){return e(this,o),a(this,(o.__proto__||Object.getPrototypeOf(o)).call(this))}return s(o,n),i(o,[{key:"init",value:function(){this.scale.scaleMode=t.ScaleManager.SHOW_ALL,this.scale.fullScreenScaleMode=t.ScaleManager.SHOW_ALL,this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.scale.forceLandscape=!0,this.game.scale.windowConstraints.bottom="visual",this.game.scale.refresh(),this.game.antialias=!1,this.game.stage.smoothed=!1,t.Canvas.setImageRenderingCrisp(this.game.canvas)}},{key:"update",value:function(){this.game.state.start("preloader")}}]),o}(t.State),o=function(){function t(){e(this,t)}return i(t,[{key:"bool",value:function(){return Math.random()>=.5}}]),t}(),r=function(){function t(i){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new o;e(this,t),this.state=i,this.velocity=s,this.isLaunched=!1,this.randomizer=n,this.goLeft=a}return i(t,[{key:"create",value:function(){this.phaserSprite=this.state.game.add.sprite(this.state.game.world.centerX,this.state.game.world.centerY,"ball"),this.sprite.anchor.setTo(.5,.5),this.state.game.physics.arcade.enable(this.sprite),this.spriteBody.collideWorldBounds=!0,this.spriteBody.bounce.setTo(1,1)}},{key:"reset",value:function(t){this.sprite.x=this.state.game.world.centerX,this.sprite.y=this.state.game.world.centerY,this.spriteBody.velocity.setTo(0,0),this.isLaunched=!1,this.goLeft=t}},{key:"launch",value:function(){var t=this.goLeft?-1:1,e=this.randomizer.bool()?-1:1;this.spriteBody.velocity.x=t*this.velocity,this.spriteBody.velocity.y=e*this.velocity,this.isLaunched=!0}},{key:"toggle",value:function(){return this.isLaunched?(this.reset(this.goLeft),!1):(this.launch(),!0)}},{key:"spriteBody",get:function(){return this.phaserSprite.body}},{key:"sprite",get:function(){return this.phaserSprite}}]),t}(),h=function(){function t(i){e(this,t),this.state=i,this.value=0}return i(t,[{key:"create",value:function(t,e){this.bitmap=this.state.game.add.bitmapText(Math.floor(t),Math.floor(e),"Press Start 2P","0",32)}},{key:"increase",value:function(){this.value+=1,this.bitmap.text=""+this.value}}]),t}(),l=function(){function t(i,s,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:250,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new h(i);e(this,t),this.state=i,this.paddleObj=s,this.ball=a,this.maxVelocity=n,this.scoreObj=o}return i(t,[{key:"create",value:function(){this.paddleObj.create(this.state.game.world.width-8,this.state.game.world.centerY),this.scoreObj.create(this.state.game.world.width-128,128)}},{key:"update",value:function(){this.paddleBody.velocity.setTo(this.ballBody.velocity.y),this.paddleBody.velocity.x=0,this.paddleBody.maxVelocity.y=this.maxVelocity}},{key:"paddleBody",get:function(){return this.paddleObj.sprite.body}},{key:"ballBody",get:function(){return this.ball.sprite.body}},{key:"paddle",get:function(){return this.paddleObj}},{key:"score",get:function(){return this.scoreObj}}]),t}(),u=function(){function t(i,s){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new h(i);e(this,t),this.state=i,this.paddleObj=s,this.scoreObj=a}return i(t,[{key:"create",value:function(){this.paddleObj.create(0,this.state.game.world.centerY),this.scoreObj.create(128,128)}},{key:"update",value:function(){this.paddleObj.move(this.state.game.input.y)}},{key:"paddle",get:function(){return this.paddleObj}},{key:"score",get:function(){return this.scoreObj}}]),t}(),c=function(){function t(i){e(this,t),this.state=i}return i(t,[{key:"create",value:function(){this.sound=this.state.game.add.audio("music")}},{key:"toggle",value:function(t){return t?(this.sound.paused?this.sound.resume():this.sound.play(),!0):(this.sound.pause(),!1)}},{key:"pause",value:function(){this.sound.pause()}}]),t}(),d=function(){function t(i){e(this,t),this.state=i}return i(t,[{key:"create",value:function(t,e){this.phaserSprite=this.state.game.add.sprite(t,e,"paddle"),this.phaserSprite.anchor.setTo(.5,.5),this.state.game.physics.arcade.enable(this.phaserSprite),this.spriteBody.collideWorldBounds=!0,this.spriteBody.immovable=!0,this.phaserSprite.scale.setTo(.5,.5),this.minY=.5*this.phaserSprite.height,this.maxY=this.state.game.world.height-.5*this.phaserSprite.height}},{key:"move",value:function(t){this.phaserSprite.y=t,this.phaserSprite.y<this.minY?this.phaserSprite.y=this.minY:this.phaserSprite.y>this.maxY&&(this.phaserSprite.y=this.maxY)}},{key:"spriteBody",get:function(){return this.phaserSprite.body}},{key:"sprite",get:function(){return this.phaserSprite}}]),t}(),p=function(t){function n(){e(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.ball=new r(t),t.players=[new u(t,new d(t)),new l(t,new d(t),t.ball)],t.music=new c(t),t}return s(n,t),i(n,[{key:"create",value:function(){var t=this;this.music.create(),this.ball.create(),this.players.forEach(function(t){t.create()}),this.game.input.onDown.add(function(){t.music.toggle(t.ball.toggle())},this)}},{key:"update",value:function(){var t=this;this.players.forEach(function(e){e.update(),t.game.physics.arcade.collide(e.paddle.sprite,t.ball.sprite,function(){return t.game.sound.play("hit")})}),(this.ballBody.blocked.up||this.ballBody.blocked.down)&&this.game.sound.play("wall"),this.ballBody.blocked.left&&this.score(this.players[1],!1),this.ballBody.blocked.right&&this.score(this.players[0],!0)}},{key:"score",value:function(t,e){t.score.increase(),this.game.sound.play("score"),this.ball.reset(e),this.music.pause()}},{key:"ballBody",get:function(){return this.ball.sprite.body}}]),n}(t.State),y=function(t){function n(){return e(this,n),a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this))}return s(n,t),i(n,[{key:"preload",value:function(){this.game.load.image("paddle","images/paddle.png"),this.game.load.image("ball","images/ball.png"),this.game.load.bitmapFont("Press Start 2P","fonts/Press_Start_2P_0.png","fonts/Press_Start_2P.fnt"),this.game.load.audio("hit",["audio/hit.wav"]),this.game.load.audio("score",["audio/score.wav"]),this.game.load.audio("wall",["audio/wall.wav"]),this.game.load.audio("music",["audio/at-night-psg.mp3","audio/at-night-psg.ogg"])}},{key:"update",value:function(){this.game.state.start("game")}}]),n}(t.State);(new(function(){function s(){e(this,s),this.game=new t.Game({width:1024,height:576,renderer:t.AUTO,parent:"game-container"})}return i(s,[{key:"start",value:function(){this.game.state.add("boot",new n),this.game.state.add("preloader",new y),this.game.state.add("game",new p),this.game.state.start("boot")}}]),s}())).start()}(Phaser);
